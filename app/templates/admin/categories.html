{% extends "admin/base.html" %}

{% block layout %}
<div class="admin-shell">
    {% include "admin/partials/sidebar.html" %}
    <main class="admin-content">
        <header class="admin-header">
            <h1>Categories</h1>
            <a class="btn primary" href="/admin/categories/new">Add category</a>
        </header>
        <section class="panel">
            <header>
                <h2>Category library</h2>
                <input type="search" placeholder="Search categories" disabled />
            </header>
            {% if page_message %}
            <div class="form-error" role="alert">{{ page_message }}</div>
            {% endif %}
            {% if categories %}
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Slug</th>
                        <th>Products</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for category in categories %}
                    <tr>
                        <td>
                            <span style="padding-left: {{ category.depth * 16 }}px;">
                                {% if category.depth > 0 %}&#8627; {% endif %}
                                {{ category.name }}
                            </span>
                        </td>
                        <td>{{ category.slug }}</td>
                        <td>{{ category.product_count }}</td>
                        <td>
                            {% if category.is_active %}
                            <span class="status-pill success">Active</span>
                            {% else %}
                            <span class="status-pill muted">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <a class="btn small" href="/admin/categories/{{ category.id }}/edit">Edit</a>
                            <form method="post" action="/admin/categories/{{ category.id }}/delete" style="display:inline;" onsubmit="return confirm('Delete this category and all of its subcategories?');">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
                                <button class="btn ghost small" type="submit">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="empty-state">No categories yet. Create one to organize products.</p>
            {% endif %}
        </section>
    </main>
</div>
{% endblock %}
