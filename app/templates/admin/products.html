{% extends "admin/base.html" %}

{% block layout %}
<div class="admin-shell">
    {% include "admin/partials/sidebar.html" %}
    <main class="admin-content">
        <header class="admin-header">
            <h1>Products</h1>
            <a class="btn primary" href="/admin/products/new">Add product</a>
        </header>
        <section class="panel">
            <header>
                <h2>Product catalog</h2>
                <form class="search-form" method="get">
                    <label class="sr-only" for="product-search">Search products</label>
                    <input id="product-search" type="search" name="q" placeholder="Search products" value="{{ search_term }}" />
                    {% if search_term %}
                    <a class="btn ghost small" href="/admin/products">Clear</a>
                    {% endif %}
                </form>
            </header>
            {% if products %}
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>SKU</th>
                        <th>OEM Reference</th>
                        <th>Category</th>
                        <th>Images</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    <tr>
                        <td>{{ product.name }}</td>
                        <td>{{ product.sku }}</td>
                        <td>{{ product.oem_number }}</td>
                        <td>{{ product.category or "â€”" }}</td>
                        <td>{{ product.image_count }}</td>
                        <td>
                            {% if product.is_active %}
                            <span class="status-pill success">Active</span>
                            {% else %}
                            <span class="status-pill muted">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <a class="btn small" href="/admin/products/{{ product.id }}/edit">Edit</a>
                            <form method="post" action="/admin/products/{{ product.id }}/delete" style="display:inline;" onsubmit="return confirm('Delete this product all of its images?');">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />
                                <button class="btn ghost small" type="submit">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="empty-state">
                {% if search_term %}
                No products found for "{{ search_term }}".
                {% else %}
                No products yet. Start by adding your first product.
                {% endif %}
            </p>
            {% endif %}
        </section>
    </main>
</div>
{% endblock %}
